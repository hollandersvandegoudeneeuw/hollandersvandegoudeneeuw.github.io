$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.controllers",[]),angular.module("app.services",[]),angular.module("app.directives",[]),angular.module("app",["ngSanitize","ngResource","ngAnimate","templates","ui.router","ui.bootstrap","app.controllers","app.directives","app.services"]).constant("APIConfig","localhost"==window.location.hostname?{backend:"http://goldenage.miraclethings.nl/api/"}:{backend:"http://goldenage.miraclethings.nl/api/"}).run(["$cacheFactory","$http",function(e,t){t.defaults.cache=e("default")}]).value("Constants",{YOU:351}).config(["$stateProvider","$urlRouterProvider",function(e,t){var r={story:["APIService","AuthService","$stateParams",function(e,t,r){return t.isAuthorized().then(function(){return e.get("goldenage/storydata",{id:r.storyId})})}]},o={login:["AuthService",function(e){return e.isAuthorized()}]};e.state("start",{url:"/start",views:{master:{controller:"StartCtrl"}}}).state("login",{url:"/login",views:{master:{templateUrl:"app/templates/login.html",controller:"LoginCtrl"}}}).state("page",{url:"/page",views:{master:{templateUrl:"app/templates/page.html"}}}).state("page.help",{url:"/help",views:{detail:{templateUrl:"app/templates/help.html"}}}).state("page.credits",{url:"/credits",views:{detail:{templateUrl:"app/templates/credits.html"}}}).state("choose",{url:"/choose",resolve:o,views:{master:{templateUrl:"app/templates/story.html"},"detail@choose":{templateUrl:"app/templates/choose.html",controller:"ChooseCtrl"}}}).state("story",{url:"/:storyId",resolve:r,views:{master:{templateUrl:"app/templates/story.html",controller:["$scope","story","$state",function(e,t,r){e.story=t}]}}}).state("story.timeline",{url:"/timeline",views:{"detail@story":{templateUrl:"app/templates/timeline.html",controller:"TimelineCtrl"}}}).state("story.favorites",{url:"/favorites",views:{"detail@story":{templateUrl:"app/templates/favorites.html",controller:"FavoritesCtrl"}}}).state("story.profile",{url:"/profile",views:{"detail@story":{templateUrl:"app/templates/profile.html",controller:"ProfileCtrl"}}}).state("story.person",{url:"/person/:personId",views:{"detail@story":{templateUrl:"app/templates/person.html",controller:"PersonCtrl"}}}).state("story.group",{url:"/group/:groupId",views:{"detail@story":{templateUrl:"app/templates/group.html",controller:"GroupCtrl"}}}).state("story.hashtag",{url:"/hashtag/:hashtagId",views:{"detail@story":{templateUrl:"app/templates/hashtag.html",controller:"HashtagCtrl"}}}),t.otherwise("/start")}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.controllers").controller("AppCtrl",["$scope","$modal","$rootScope","$state","AuthState",function(e,t,r,o,a){e.$state=o,e.state=a,r.lang="nl"==navigator.language.substr(0,2)?"nl":"en",e.blurred=!0}]).controller("StartCtrl",["$scope","$state","AuthService","AuthState",function(e,t,r,o){r.isAuthorized().then(function(e){t.go("choose")},function(){t.go("login")})}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.controllers").controller("ChooseCtrl",["$scope","$state",function(e,t){console.log("choose")}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.controllers").controller("FavoritesCtrl",["$scope","$modal","AuthState","story","StoryContainer",function(e,t,r,o,a){var n=r.profile,i=new a(o);e.cards=i.filterCards(n.likes)}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.controllers").controller("GroupCtrl",["$scope","$stateParams","story",function(e,t,r){e.group=r.groups[t.groupId]}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.controllers").controller("LoginCtrl",["$scope","$state","AuthService","AuthState",function(e,t,r,o){e.errorMessage=null,e.login=function(){e.loginForm.$valid&&r.login(e.email).then(function(e){t.go("start")},function(t){console.log(t),e.errorMessage="This e-mail address is unknown."})}}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.controllers").controller("PersonCtrl",["$scope","$stateParams","StoryContainer","story",function(e,t,r,o){e.person=o.persons[t.personId];var a=new r(o);e.cards=a.filterPersonCards(e.person.id),e.groups=_(o.groups).filter(function(t){return void 0!==_.find(t.members,{id:e.person.id})}).each(function(e){if(e.members.length>4){var t=e.members.splice(4);e.members.push({rest:t.length})}for(var r=0;r<e.members.length;r++)e.members[r].hiddensm=r>2;return e}).value()}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.controllers").controller("ProfileCtrl",["$scope","story","$modal","AuthState","AuthService",function(e,t,r,o,a){e.logout=a.logout,e.network=_.map(t.network,function(e){return t.persons[e]}),console.log(e.network)}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.controllers").controller("TimelineCtrl",["$scope","$modal","AuthState","story","i18n","StoryContainer",function(e,t,r,o,a,n){var i=new n(o);e.cards=i.filterCards(r.profile.read)}]).controller("CardListCtrl",["$scope","i18n","AuthState","APIService",function(e,t,r,o){function a(e){return _.contains(r.profile.likes,e.id)}e.toggleLike=function(e){var t=a(e);o.post("goldenage/favorite",{card_id:e.id,"delete":t}),t?r.profile.likes=_.difference(r.profile.likes,[e.id]):r.profile.likes.push(e.id)},e.likeImage=function(e){return a(e)?"/img/ic_card_heart_on.png":"/img/ic_card_heart_off.png"},e.likeText=function(e,r){var o=[];if(a(e)&&o.push(t("like_text_you")),_.each(e.likes||[],function(e){o.push(r.persons[e].title)}),!o.length)return"";var n=t("like_text_template_plural");1==o.length&&(n=t(a(e)?"like_text_template_single_1stperson":"like_text_template_single"));var i=o.join(", ");if(o.length>1){var l=i.lastIndexOf(", ");i=i.substring(0,l)+t("like_text_and")+i.substring(l+1)}return n.replace(/%s/,i)}}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.directives").directive("scrollContainer",["$window","$timeout",function(e,t){return{restrict:"A",link:function(e,r){r.addClass("scroll-area"),r.css("opacity",0),t(function(){r.toggleClass("scrollbar",r[0].scrollHeight>r[0].clientHeight),r.css("opacity",1)})}}}]).directive("subnavHeader",["$window",function(e){return{restrict:"E",templateUrl:"app/templates/ui/subnav_header.html",scope:{title:"@"},link:function(t){t.back=function(){e.history.back()}}}}]).directive("cardImage",["$sce","$compile","$state","i18n","Constants",function(e,t,r,o,a){return{restrict:"E",scope:{card:"=",story:"=",profile:"=",who:"@"},template:'<img ng-src="{{ image }}" ng-show="visible" class="card-profile-image" />',replace:!0,link:function(e,t){if(e.visible=!!e.card[e.who],e.visible){var r=e.card[e.who],o=e.story.persons[r]||e.story.groups[r];r==a.YOU&&(o=e.profile),o&&(e.image=o.image)}}}}]).directive("cardTitle",["$sce","$compile","$state","i18n","Constants",function(e,t,r,o,a){return{restrict:"E",scope:{card:"=",story:"=",profile:"="},replace:!0,link:function(e,n){function i(t,r){var o=e.story.persons[r]||e.story.groups[r];r==a.YOU&&(o=e.profile);var n="<a href ng-click='click("+r+")'>"+o.title+"</a>";return s.replace(t,n)}var l=e.card.category;switch(l){case"checkin":0!==e.card.target&&(l+="_target")}var s=o("card_title_"+l);e.card.author&&(s=i("[author]",e.card.author)),e.card.target&&(s=i("[target]",e.card.target)),e.click=function(t){return t==a.YOU?void r.go("story.profile",{storyId:e.story.id}):e.story.persons[t]?void r.go("story.person",{storyId:e.story.id,personId:t}):e.story.groups[t]?void r.go("story.group",{storyId:e.story.id,groupId:t}):void 0},n.html("<div class='card-title'>"+s+"</div>"),t(n.contents())(e)}}}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.services").factory("APIService",["$q","$http","APIConfig","AuthState",function(e,t,r,o){function a(e){e||(e=o.getEmail()),t.defaults.headers.common.Authorization=e?"E-mail "+e:null}return{get:function(e,o,n){var i=o?"?"+$.param(o):"";return a(n),t({url:r.backend+e+i,method:"GET",cache:!0}).then(function(e){return e.data})},post:function(e,o){return t.post(r.backend+e,o).then(function(e){return e.data})}}}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.services").value("AuthState",{getEmail:function(){return localStorage.email},setEmail:function(e){e?localStorage.email=e:delete localStorage.email},profile:null,stories:null}).factory("AuthService",["$q","$state","$http","AuthState","APIService",function(e,t,r,o,a){function n(e){return o.profile=e,a.get("goldenage/stories").then(function(e){return o.stories=e,!0})}function i(){return a.get("goldenage/userinfo",{},o.getEmail()).then(n)}function l(e){return a.get("goldenage/userinfo",{},e).then(function(t){return o.setEmail(e),n(t)})}function s(){o.setEmail(null),r.defaults.cache.removeAll(),t.go("start")}return{isAuthorized:i,login:l,logout:s}}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.services").factory("i18n",["$rootScope",function(e){var t={en:{login_title:"Welcome to the Golden Age!",login_text:"This website is part of the app and educational program #goldenAge. Please first visit the exhibition before using this website. Afterwards, log in with the same e-mail address that you used in the app.",login_placeholder:"E-mail address",login_btn:"Login",choose_header:"Choose a story to start",choose_text:"Pick a story from the list on the left.",like_text_you:"You",like_text_and:" and ",like_text_template_plural:"%s like this",like_text_template_single:"%s likes this",like_text_template_single_1stperson:"%s like this",person_biography:"Biography",person_details:"Personal details",heading_network:"Network",card_title_attend_event:"[author] created an event",card_title_attend_event_you:"You are attending an event",card_title_checkin:"[author] checked in",card_title_checkin_target:"[author] checked in at [target]",card_title_friend_request:"[author] wants to become friends with [target]",card_title_friend_request_you:"[author] wants to add you to their network",card_title_friendship:"[author] has become friends with [target]",card_title_friendship_you:"[author] added you to their network",card_title_join_group:"[author] joined the group [target]",card_title_join_group_you:"You joined the group [target]",card_title_private_message:"[author] wrote a message to [target]",card_title_private_message_you:"[author] wrote you a message",card_title_status_update:"[author] wrote a status update",card_title_tag_picture:"[author] tagged [target] in a picture",card_title_tag_picture_no_target:"[author] is tagged in a picture",card_title_tag_picture_self:"[author] tagged himself in a picture",card_title_tag_picture_you:"[author] tagged you in a picture"},nl:{login_title:"Welkom in de Gouden Eeuw!",login_text:"Deze website behoort bij de applicatie en het educatieprogramma #goudenEeuw. Bezoek eerst de tentoonstelling in het kader van dit educatieprogramma voordat je deze website gebruikt. Login met hetzelfde e-mailadres als je hebt gebruikt tijdens je bezoek.",login_placeholder:"E-mailadres",login_btn:"Login",choose_header:"Kies een verhaal",choose_text:"Kies een verhaal uit de lijst aan de linkerkant.",like_text_you:"Jij",like_text_and:" en ",like_text_template_plural:"%s vindt dit leuk",like_text_template_single:"%s vinden dit leuk",like_text_template_single_1stperson:"%s vindt dit leuk",person_biography:"Biografie",person_details:"Persoonlijke details",heading_network:"Netwerk",card_title_attend_event:"[author] heeft een event aangemaakt",card_title_attend_event_you:"Je gaat naar een event",card_title_checkin:"[author] is ingechecked",card_title_checkin_target:"[author] is ingechecked bij [target]",card_title_friend_request:"[author] wil vrienden worden met [target]",card_title_friend_request_you:"[author] wil met je netwerken",card_title_friendship:"[author] is bevriend geworden met [target]",card_title_friendship_you:"[author] heeft je toegevoegd aan zijn netwerk",card_title_join_group:"[author] is lid geworden van [target]",card_title_join_group_you:"Je bent lid geworden van [target]",card_title_private_message:"[author] stuurde een bericht naar [target]",card_title_private_message_you:"[author] stuurde je een privébericht",card_title_status_update:"[author] schreef een statusupdate",card_title_tag_picture:"[author] tagde [target] in een schilderij",card_title_tag_picture_no_target:"[author] is getagged in een schilderij",card_title_tag_picture_self:"[author] tagde zichzelf in een foto",card_title_tag_picture_you:"[author] heeft jou in een foto getagd"}};return function(r){return t[e.lang][r]||"?"+r+"?"}}]).filter("i18n",["i18n",function(e){return e}]),{}}),$traceurRuntime.ModuleStore.getAnonymousModule(function(){"use strict";return angular.module("app.services").factory("StoryContainer",function(){return function(e){var t=this;return t.findCard=function(t){for(var r in e.chapters)for(var o in e.chapters[r].cards){var a=e.chapters[r].cards[o];if(a.id==t)return a}return null},t.filterCards=function(e){var r=_.reduce(e,function(e,r){var o=t.findCard(r);return o&&e.push(o),e},[]);return r.reverse(),r},t.filterPersonCards=function(t){var r=[];for(var o in e.chapters)for(var a in e.chapters[o].cards){var n=e.chapters[o].cards[a];(n.author==t||n.target==t)&&r.push(n)}return r},t}}),{}});